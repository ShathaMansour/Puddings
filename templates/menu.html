{% extends "index.html" %}
{% block title %}Menu • Pudding’s{% endblock %}
{% set active = 'menu' %}

{% block content %}

<div class="menu-layout">

    <!-- LEFT SIDEBAR WITH CATEGORY LINKS -->
    <aside class="menu-sidebar">
        {% for category in categories.keys() %}
            <a href="#cat-{{ loop.index }}" class="sidebar-category">
                {{ category }}
            </a>
        {% endfor %}

<a href="/cart" class="sidebar-cart-btn">
    Cart 
    {% if cart_count > 0 %}
        <span class="cart-counter">{{ cart_count }}</span>
    {% endif %}
</a>
    </aside>


    <!-- RIGHT MAIN CONTENT -->
    <section class="menu-content">

        {% for category, items in categories.items() %}
        <div id="cat-{{ loop.index }}" class="menu-category-section">

            <h2 class="menu-category-title">{{ category }}</h2>

            <div class="menu-grid">

                {% for item in items %}
                <div class="menu-item-card">

<div class="menu-item-image">
    {% if item["image"] %}
        <img class="menu-item-img"
             src="{{ url_for('static', filename=item['image']) }}"
             alt="{{ item['name'] }}">
    {% else %}
        <div class="no-img">No Image</div>
    {% endif %}
</div>



                    <!-- ITEM NAME + PRICE -->
                    <h3 class="menu-item-name">
                        {{ item["name"] }}
                        <span class="item-price">£{{ "%.2f"|format(item["price"]) }}</span>
                    </h3>

                    <p class="menu-item-desc">{{ item["description"] }}</p>

<div class="menu-item-actions">

    <div class="qty-selector" data-item="{{ item.id }}">
        <button type="button" class="qty-btn minus">–</button>
        <span class="qty-number">1</span>
        <button type="button" class="qty-btn plus">+</button>
    </div>

    <form method="POST" action="/add-to-cart/{{ item.id }}" class="add-form">
        <input type="hidden" name="quantity" value="1" class="qty-input">
        <button class="add-btn">Add</button>
    </form>

</div>


                </div>
                {% endfor %}

            </div>
        </div>
        {% endfor %}

    </section>

</div>
<script>
document.querySelectorAll(".qty-selector").forEach(selector => {
    const minus = selector.querySelector(".minus");
    const plus = selector.querySelector(".plus");
    const number = selector.querySelector(".qty-number");
    const form = selector.parentElement.querySelector(".add-form");
    const input = form.querySelector(".qty-input");

    let qty = 1;

plus.addEventListener("click", () => {
    if (qty < 5) {                  // ⭐ LIMIT 5
        qty++;
        number.textContent = qty;
        input.value = qty;
    }
});


    minus.addEventListener("click", () => {
        if (qty > 1) {
            qty--;
            number.textContent = qty;
            input.value = qty;
        }
    });
});
</script>


{% endblock %}
